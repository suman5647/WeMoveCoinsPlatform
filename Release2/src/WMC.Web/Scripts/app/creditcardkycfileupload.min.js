function sendFileToServer(n,t,i){var r=$.ajax({xhr:function(){var n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(n){var t=0,r=n.loaded||n.position,u=n.total;n.lengthComputable&&(t=Math.ceil(r/u*100));i.setProgress(t)},!1),n},url:"/CreditCardKYCFileUpload",type:"POST",contentType:!1,processData:!1,cache:!1,data:n,success:function(n){i.setProgress(100);$.each(n,function(n,i){$("#btn-submit").prop("disabled",!1);t=="PhotoID"?$("#photoIDUploadedFiles").append("<span id="+i.id+"><img src='images/close.png' alt='' onclick='removeFile("+i.id+");'/> "+i.originalFilename+"<br><\/span>"):t=="ProofOfRecidency"&&$("#proofOfRecidencyUploadedFiles").append("<span id="+i.id+"><img src='images/close.png' alt='' onclick='removeFile("+i.id+");'/> "+i.originalFilename+"<br><\/span>")})},error:function(n){$("#KYCFileTypeErrorModal").find("#modalContent").html(n.responseJSON.errorMessage);$("#KYCFileTypeErrorModal").modal("show")}});i.setAbort(r)}function createStatusbar(){rowCount++;var n="odd";rowCount%2==0&&(n="even");this.statusbar=$("<div class='statusbar "+n+"'><\/div>");this.filename=$("<div class='filename'><\/div>").appendTo(this.statusbar);this.size=$("<div class='filesize'><\/div>").appendTo(this.statusbar);this.progressBar=$("<div class='progressBar'><div><\/div><\/div>").appendTo(this.statusbar);this.abort=$("<div class='abort'>Abort<\/div>").appendTo(this.statusbar);this.setFileNameSize=function(n,t){var i="",r=t/1024,u;parseInt(r)>1024?(u=r/1024,i=u.toFixed(2)+" MB"):i=r.toFixed(2)+" KB";this.filename.html(n);this.size.html(i)};this.setProgress=function(n){var t=n*this.progressBar.width()/100;this.progressBar.find("div").animate({width:t},10).html(n+"% ");parseInt(n)>=100&&this.abort.hide()};this.setAbort=function(n){var t=this.statusbar;this.abort.click(function(){n.abort();t.hide()})}}function handleMultipleFileUpload(n,t,i,r){for(var e,f,o,u=0;u<n.length;u++){e=n[u].name.split(".").pop();switch(e.toUpperCase()){case"PNG":case"JPG":case"JPEG":break;default:alert("File types with ."+e+" extensions is not allowed.");return}f=new FormData;f.append("kycFile"+u,n[u]);f.append("fileType",i);f.append("userIdentity",r);o=new createStatusbar(t);o.setFileNameSize(n[u].name,n[u].size);sendFileToServer(f,i,o)}}function addDragDropHandlers(n,t,i){n.on("dragenter",function(n){n.stopPropagation();n.preventDefault();$(this).css("border","2px solid #92AAB0")});n.on("dragleave",function(n){n.stopPropagation();n.preventDefault();$(this).css("border","2px dashed #92AAB0")});n.on("dragover",function(n){n.stopPropagation();n.preventDefault()});n.on("drop",function(r){$(this).css("border","2px dashed #92AAB0");r.preventDefault();handleMultipleFileUpload(r.originalEvent.dataTransfer.files,n,t,i)})}function removeFile(n){var t=$.ajax({url:"/CreditCardDeleteKYCFile",type:"POST",data:{id:n},success:function(){$("#"+n).remove();$("#btn-submit").prop("disabled","disabled")},error:function(){}})}function initkycFileUpload(n){addDragDropHandlers($("#dragdrophandlerfileProofOfRecidency"),"ProofOfRecidency",n);$(document).on("dragenter",function(n){n.stopPropagation();n.preventDefault()});$(document).on("dragover",function(n){n.stopPropagation();n.preventDefault();$("#dragdrophandlerfileProofOfRecidency").css("border","2px dashed #92AAB0")});$(document).on("drop",function(n){n.stopPropagation();n.preventDefault()})}var rowCount=0;